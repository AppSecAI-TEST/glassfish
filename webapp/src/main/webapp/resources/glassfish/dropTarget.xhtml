<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://java.sun.com/jsf/composite"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:trh="http://myfaces.apache.org/trinidad/html">

    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="type" required="false" type="java.lang.String"/>
        <cc:attribute name="dropListener" method-signature="java.lang.String action()" required="true"/>
<!--        <cc:actionSource name="actionButton"/>-->
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>
        <h:outputScript library="javax.faces" name="jsf.js" target="head"/>

        <h:panelGroup id="foo" style1="visibility: hidden">
            <tr:commandButton id="actionButton" text="submit" action="#{cc.attrs.dropListener}">
                <f:ajax render="@form" execute="@form" listener="#{myBean.updateVisibility}"/>
            </tr:commandButton>
            <h:inputText id="droppedValue"/>
        </h:panelGroup>
        <script type="text/javascript">
            function handle(data) {
                alert(data);
            };

            $('##{cc.attrs.parent.id}').droppable({
                scope: '#{cc.attrs.type}',
                drop : function (event, ui) {
                    document.getElementById('#{cc.clientId}:droppedValue').value = ui.draggable.prop('source');
                    document.getElementById('#{cc.clientId}:actionButton').click();
                    /*
                    jsf.ajax.request('#{cc.clientId}:actionButton', null, {
//                        onerror: handle,
//                        onevent: handle,
                        params: {
                            execute:'actionButton',
                            render:'#{cc.attrs.parent.clientId}',
                            dropSource : ui.draggable.prop('source')
                        }
                    });
                    */
                }
            });
        </script>
    </cc:implementation>
</html>
